#!/usr/bin/env ruby

require 'optparse'
require 'methadone'
require 'rperf'

class App
  include Methadone::Main
  include Methadone::CLILogging
  include Methadone::SH

  main do # Add args you want: |like,so|
    # your program code here
    # You can access CLI options via
    # the options Hash
  end

  # supplemental methods here

  # Declare command-line interface here

  description "IO performance testing utility"

  #
  # Accept flags via:
  # on("--flag VAL","Some flag")
  # options[flag] will contain VAL
  #
  # Specify switches via:
  # on("--[no-]switch","Some switch")
  #
  # Or, just call OptionParser methods on opts
  #
  # Require an argument

  arg :FILE_OR_DEVICE, :required, :many, 
    <<EOF
File or device to read and write, along with an optional size
	specification.  By default, rperf will use the entire size of the
	device. Multiple files or devices may be specified.

	Examples: 

	1) 'rperf /dev/sdb' will perform IO to the entire size of the /dev/sdb
	    device, 

	2) 'rperf myfile$5G' will perform IO to the first 5 GiB of the file
	   'myfile' regardless of it's current size." 
EOF

  #
  # # Make an argument optional
  # arg :optional_arg, :optional

  version Rperf::VERSION

  use_log_level_option

  go!
end
